

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Part 4 - Organizing your Project / UI and Simple Templating &mdash; Recipe Website Tutorial 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Recipe Website Tutorial 1.0 documentation" href="../index.html" />
    <link rel="next" title="Part 5 - Common Application Features/Adding Features to the Recipe Website" href="common-application-features.html" />
    <link rel="prev" title="Part 3 - Deploying your Application" href="deploying-your-application.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="common-application-features.html" title="Part 5 - Common Application Features/Adding Features to the Recipe Website"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="deploying-your-application.html" title="Part 3 - Deploying your Application"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Recipe Website Tutorial 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="part-4-organizing-your-project-ui-and-simple-templating">
<span id="organizing-project-chapter"></span><span id="index-0"></span><h1>Part 4 - Organizing your Project / UI and Simple Templating<a class="headerlink" href="#part-4-organizing-your-project-ui-and-simple-templating" title="Permalink to this headline">¶</a></h1>
<p>At this point we have covered the following</p>
<dl class="docutils">
<dt><a class="reference internal" href="planning-and-mockups.html#planning-mockups-chapter"><em>Part 1 - Planning and Mockups</em></a></dt>
<dd>Where we looked at process of planning the user interface (UI) of your application</dd>
<dt><a class="reference internal" href="setting-up-dev-environment.html#setting-up-dev-chapter"><em>Part 2 - Setting up your development environment and starting an application</em></a></dt>
<dd>This looked at what we needed on our computer to get started.
We also gained some experience with configuring views (routes) and templates by working on a simple application.</dd>
<dt><a class="reference internal" href="deploying-your-application.html#deploying-application-chapter"><em>Part 3 - Deploying your Application</em></a></dt>
<dd>We have explored the details of publishing your application to the web</dd>
</dl>
<p>You should now know enough to begin working on the prototype for our Recipe Website.
The prototype will implement the layout.</p>
<p>We only want to worry about putting placeholder text in in the grids.
We will NOT concern ourselves with fancy css or images yet.</p>
<p>By the end of this tutorial you will have reviewed the following topics:</p>
<ul class="simple">
<li>Use the starter scaffold as a starting point for our application</li>
<li>Create a global layout using the jinja2 templating language</li>
<li>Make use of jsonify and request methods</li>
<li>Use the <a class="reference external" href="https://github.com/defunkt/jquery-pjax">pjax</a> library for smart ajax based page reloads</li>
</ul>
<div class="section" id="setting-up-the-flask-starter-scaffold">
<h2>Setting up the Flask Starter Scaffold<a class="headerlink" href="#setting-up-the-flask-starter-scaffold" title="Permalink to this headline">¶</a></h2>
<p>A scaffold refers to a predetermined structure around which you will build your applications.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>Why Scaffolds?</strong> Glad you asked! Over the next couple weeks you will be submitting work to be assessed, to simplify things
we&#8217;ve developed a standard way of starting and organizing your projects. Maintaining a standard approach means there is one less decision to make when building your applications.</p>
</div>
<p>There are two scaffolds to be used in this course the names are listed below:</p>
<dl class="docutils">
<dt><strong>Starter Scaffold</strong></dt>
<dd>This is a simple approach, just enough folders to keep things organized</dd>
<dt><strong>GAE Scaffold</strong></dt>
<dd>This arrangement is meant to accomodate projects that will be deployed to Google App Engine, due to the nature of GAE it is necessary to bundles more utilities in our package.</dd>
</dl>
<p>Today we will focus on the <tt class="docutils literal"><span class="pre">Starter</span> <span class="pre">Scaffold</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section assumes that you have Virtualenv installed. You may find it helpful to
review the section entitled <a class="reference internal" href="setting-up-dev-environment.html#virtualenv-section"><em>Using Bootstrapflask.py to setup Flask and Virtualenv</em></a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You will need to download the Flask Starter Scaffold <a class="reference external" href="http://dl.dropbox.com/u/1004432/flask_starter.zip">http://dl.dropbox.com/u/1004432/flask_starter.zip</a>. If you are using Windows, just download it with your webbrowser.</p>
</div>
<p>1. Download and unzip the starter scaffold <a class="reference external" href="http://dl.dropbox.com/u/1004432/flask_starter.zip">http://dl.dropbox.com/u/1004432/flask_starter.zip</a>
copy <cite>flask_starter</cite> to <cite>recipe_website</cite> this effectively uses the flask_starter folder as the &#8220;blueprint&#8221; for your projects:</p>
<div class="highlight-python"><pre>wget http://dl.dropbox.com/u/1004432/flask_starter.zip
unzip flask_starter
cp -r flask_starter recipe_website</pre>
</div>
<ol class="arabic">
<li><p class="first">Enter the new <cite>recipe_website</cite> folder, bootstrap flask and activate your virtual environment:</p>
<p>cd recipe_website
python bootstrapflask.py
source venv/bin/activate</p>
</li>
</ol>
<p>The unzipped directory structure looks something like this (for the sake of simplicity, only the key files and folders are listed below):</p>
<div class="highlight-python"><pre>recipe_website
├── app.py
├── static
│   ├── css
│   ├── images
│   └── js
├── templates
└── venv</pre>
</div>
<p>Check to see that everything is working by running the following:</p>
<div class="highlight-python"><pre>python app.py</pre>
</div>
<p>Visit your browser at <a class="reference external" href="http://localhost:6543">http://localhost:6543</a>, you should see something like the
image below:</p>
<img alt="../_images/scaffoldview.png" src="../_images/scaffoldview.png" />
<p>If you are on a network with a proxy you will need to review <a class="reference internal" href="setting-up-dev-environment.html#dealing-with-proxies"><em>Dealing with on campus proxies</em></a> for setting your http_proxy environment variable.</p>
</div>
<div class="section" id="creating-the-views-for-our-recipewebsite-application">
<h2>Creating the views for our RecipeWebsite application<a class="headerlink" href="#creating-the-views-for-our-recipewebsite-application" title="Permalink to this headline">¶</a></h2>
<p>Based on what we know about our application we can predict some of our required views.</p>
<p>The names below represent reasonably descriptive choices for our Views, (later on, we may choose to use different names for our views):</p>
<dl class="docutils">
<dt>welcome</dt>
<dd>a view which shows a welcome or home page, it is associated with the root of the website.</dd>
<dt>recipe</dt>
<dd>when viewing an individual recipe, this view will be used to display all the information for that recipe.</dd>
<dt>queryby_ingredient</dt>
<dd>search by ingredient, this view will return a list of recipes that have the particular ingredient.</dd>
<dt>submitrecipe</dt>
<dd>It should be possible to add a new recipe using the &#8216;submit a recipe&#8217; link.</dd>
<dt>registration</dt>
<dd>There needs to be a registration page, so that new users can sign up</dd>
<dt>faq</dt>
<dd>This will be a simple view that lists common questions about the web application</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Point of Interest - the term &#8220;scaffold&#8221; comes from the construction industry and roughly means &#8220;structure&#8221;.</p>
</div>
</div>
<div class="section" id="adding-a-template-in-the-templates-folder">
<h2>Adding a template in the <cite>templates</cite> folder<a class="headerlink" href="#adding-a-template-in-the-templates-folder" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Templates go in the <cite>templates</cite> directory <tt class="docutils literal"><span class="pre">by</span> <span class="pre">convention</span></tt>, it is not necessary to declare this anywhere in your code or configuration. Placing your templates in the the <cite>templates</cite> folder is enough.</p>
</div>
<p>We will start by adding a new template called <cite>recipe.html</cite>. To make it very
simple we will just put the phrase, &#8220;I am the recipe template&#8221;.</p>
<div class="highlight-python"><pre>&lt;h1&gt;I am the recipe template&lt;/h1&gt;</pre>
</div>
<p>We will need a new route before this will work:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/recipe&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">recipe</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">template</span><span class="p">(</span><span class="s">&#39;recipe.html&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="view-the-new-view-in-your-browser">
<h2>View the new view in your browser<a class="headerlink" href="#view-the-new-view-in-your-browser" title="Permalink to this headline">¶</a></h2>
<p>Start the application:</p>
<div class="highlight-python"><pre>python app.py</pre>
</div>
<p>Then visit localhost:6543/recipe, you should see something like the image below.</p>
<blockquote>
<div><img alt="../_images/recipetemplate.jpg" src="../_images/recipetemplate.jpg" />
</div></blockquote>
</div>
<div class="section" id="passing-variables-to-the-template">
<h2>Passing variables to the template<a class="headerlink" href="#passing-variables-to-the-template" title="Permalink to this headline">¶</a></h2>
<p>Flask uses Jinja2 templates by default.
Variables are generally passed to Jinja2 templates as key value pairs of a python dictionary.
Notice how this approach is used in the app.py file to pass the value of <cite>name</cite> to the index.html template.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&lt;name&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;Earth&#39;</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">template</span><span class="p">(</span><span class="s">&#39;index.html&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<p>We will find this useful later.</p>
</div>
<div class="section" id="template-inheritance-and-a-master-layout-template">
<h2>Template inheritance and a master (layout) template<a class="headerlink" href="#template-inheritance-and-a-master-layout-template" title="Permalink to this headline">¶</a></h2>
<p>After a while we begin to see things that are common to all templates. Instead of repeating these elements
across different templates, we can share these elements by creating a global or master template.</p>
<p>A common pattern seen in application development, is to have a layout or master template. The other templates can then be configured to inherit from this global layout.</p>
<p>You can read more about the <a class="reference external" href="http://flask.pocoo.org/docs/patterns/templateinheritance/">template inheritance pattern</a> at the Flask website.</p>
<p>In this step, we will create a master template called <tt class="docutils literal"><span class="pre">layout.html</span></tt>. Our other templates will inherit common elements from the layout template.</p>
<p>Based on our mockups, most pages will be simpler than the front page so we will create a more generic template
based on the <cite>index.html</cite> template.</p>
<img alt="../_images/recipewebsite-template-innerpage.png" src="../_images/recipewebsite-template-innerpage.png" />
<p>We&#8217;ll create a new master template called &#8216;layout.html&#8217; in the <cite>templates</cite> folder. We can use the <cite>index.html</cite> template as the starting point.</p>
<p>The simpler global template can be implemented with 3 rows instead of the 5 that we identified for the welcome page.</p>
<img alt="../_images/simpletemplate.jpg" src="../_images/simpletemplate.jpg" />
<p>We will focus on row 2, we&#8217;ll call the area highlighted in yellow <tt class="docutils literal"><span class="pre">content</span></tt>. We add a replaceable <tt class="docutils literal"><span class="pre">block</span></tt> to our template.</p>
<p>We name our template <cite>layout.html</cite>:</p>
<div class="highlight-python"><pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;head&gt;
     &lt;style&gt;
        &lt;!--
        @import url(http://dl.dropbox.com/u/1004432/decogrids-12-gapless.css);
        --&gt;
      &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;

        &lt;div id="row-1" class="row"&gt;
              &lt;div class ="cell position-0 width-3"&gt;logo&lt;/div&gt;
              &lt;div class ="cell position-3 width-6"&gt;the menu&lt;/div&gt;
              &lt;div class ="cell position-9 width-3"&gt;search&lt;/div&gt;
        &lt;/div&gt;
        &lt;div id="row-2" class="row"&gt;
              &lt;div class ="cell position-0 width-3"&gt;recipe sidebar&lt;/div&gt;
              &lt;div class ="cell position-3 width-9"&gt;{% block content %}content goes here{% endblock %}&lt;/div&gt;
        &lt;/div&gt;
        &lt;div id="row-3" class="row"&gt;
              &lt;div class ="cell position-0 width-3"&gt;popular ingredients&lt;/div&gt;
              &lt;div class ="cell position-3 width-4"&gt;new recipes box&lt;/div&gt;
              &lt;div class ="cell position-7 width-5"&gt;popular recipes box&lt;/div&gt;
        &lt;/div&gt;

&lt;/body&gt;
&lt;/html&gt;</pre>
</div>
<p>We now have a <tt class="docutils literal"><span class="pre">content</span></tt> block.</p>
</div>
<div class="section" id="child-templates-using-our-template">
<h2>Child templates - using our template<a class="headerlink" href="#child-templates-using-our-template" title="Permalink to this headline">¶</a></h2>
<p>A child template inherits from the global template using a special <tt class="docutils literal"><span class="pre">extends</span></tt> tag.</p>
<p>Our recipe template can now be implemented like this</p>
<div class="highlight-python"><pre>{% extends "layout.html" %}

        {% block content %}
        &lt;h1&gt;I am the recipe template&lt;/h1&gt;
        {% endblock %}</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">the indentation is optional but helps to make the child template more readable</p>
</div>
<p>It will look like this:</p>
<img alt="../_images/recipetemplate-child.png" src="../_images/recipetemplate-child.png" />
<p>Notice how the <tt class="docutils literal"><span class="pre">content</span></tt> block of the child, overrides the original content block.</p>
</div>
<div class="section" id="adding-ajax-to-the-template">
<h2>Adding AJAX to the template<a class="headerlink" href="#adding-ajax-to-the-template" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>XXX Fixme ... add notes about implementing ajax Let&#8217;s add some AJAX functionality.....</div></blockquote>
<p>this will also introduce the jsonify and request methods
XXX we could use the github style page load</p>
</div>
<div class="section" id="discussion">
<h2>Discussion<a class="headerlink" href="#discussion" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Did we need to declare where to look for templates and static files?</li>
<li>What does the phrase &#8220;by convention&#8221; mean? What conventions have we seen today? What&#8217;s the purpose of having conventions?</li>
<li>In what way do conventions make source code more maintainable?</li>
<li>Read the import statements in the app.py file, what&#8217;s the original name of the the <tt class="docutils literal"><span class="pre">template</span></tt> method? Can all of this be rewritten as a single import statement?</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Part 4 - Organizing your Project / UI and Simple Templating</a><ul>
<li><a class="reference internal" href="#setting-up-the-flask-starter-scaffold">Setting up the Flask Starter Scaffold</a></li>
<li><a class="reference internal" href="#creating-the-views-for-our-recipewebsite-application">Creating the views for our RecipeWebsite application</a></li>
<li><a class="reference internal" href="#adding-a-template-in-the-templates-folder">Adding a template in the <cite>templates</cite> folder</a></li>
<li><a class="reference internal" href="#view-the-new-view-in-your-browser">View the new view in your browser</a></li>
<li><a class="reference internal" href="#passing-variables-to-the-template">Passing variables to the template</a></li>
<li><a class="reference internal" href="#template-inheritance-and-a-master-layout-template">Template inheritance and a master (layout) template</a></li>
<li><a class="reference internal" href="#child-templates-using-our-template">Child templates - using our template</a></li>
<li><a class="reference internal" href="#adding-ajax-to-the-template">Adding AJAX to the template</a></li>
<li><a class="reference internal" href="#discussion">Discussion</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="deploying-your-application.html"
                        title="previous chapter">Part 3 - Deploying your Application</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="common-application-features.html"
                        title="next chapter">Part 5 - Common Application Features/Adding Features to the Recipe Website</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/tutorials/organizing-your-project.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="common-application-features.html" title="Part 5 - Common Application Features/Adding Features to the Recipe Website"
             >next</a> |</li>
        <li class="right" >
          <a href="deploying-your-application.html" title="Part 3 - Deploying your Application"
             >previous</a> |</li>
        <li><a href="../index.html">Recipe Website Tutorial 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, David Bain.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>